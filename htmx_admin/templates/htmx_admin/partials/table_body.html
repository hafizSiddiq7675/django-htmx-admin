{% load i18n admin_urls htmx_admin_tags %}
{% if cl.result_list %}
<table id="result_list">
    <thead>
        <tr>
            <th scope="col" class="action-checkbox-column">
                <div class="text">
                    <span><input type="checkbox" id="action-toggle"></span>
                </div>
            </th>
            {% for i, field_name in cl.list_display|enumerate %}
            {% if field_name != 'action_checkbox' %}
            <th scope="col" class="column-{{ field_name }}">
                <div class="text">
                    <a href="?o={{ i|sort_param:cl }}"
                       hx-get="{% htmx_table_body_url opts %}?o={{ i|sort_param:cl }}"
                       hx-target="#result-list-container"
                       hx-swap="innerHTML"
                       class="sortable">
                        {{ field_name|capfirst }}
                        {% with current_order=i|current_sort_order:cl %}
                        {% if current_order %}
                        <span class="sort-indicator">{% if current_order == 'desc' %}▼{% else %}▲{% endif %}</span>
                        {% endif %}
                        {% endwith %}
                    </a>
                </div>
            </th>
            {% endif %}
            {% endfor %}
            {% if list_editable_htmx %}
            <th scope="col">
                <div class="text">
                    <span>{% translate "Actions" %}</span>
                </div>
            </th>
            {% endif %}
        </tr>
    </thead>
    <tbody>
        {% for result in cl.result_list %}
        <tr class="{% cycle 'row1' 'row2' %}" data-row-id="{{ result.pk }}">
            <td class="action-checkbox">
                <input type="checkbox" name="_selected_action" value="{{ result.pk }}" class="action-select">
            </td>
            {% for field_name in cl.list_display %}
            {% if field_name != 'action_checkbox' %}
            <td class="field-{{ field_name }}">
                {% if field_name in list_editable_htmx %}
                {% include "htmx_admin/partials/table_cell.html" with object=result field=field_name value=result|get_field_value:field_name is_editable=True %}
                {% else %}
                {{ result|get_field_value:field_name }}
                {% endif %}
            </td>
            {% endif %}
            {% endfor %}
            {% if list_editable_htmx %}
            <td class="htmx-actions">
                <button type="button"
                        class="btn-edit"
                        hx-get="{% htmx_modal_url opts result.pk %}"
                        hx-target="#modal-container"
                        hx-swap="innerHTML"
                        title="{% translate 'Edit' %}">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>
                </button>
                <button type="button"
                        class="btn-delete"
                        hx-delete="{% htmx_delete_url result %}"
                        hx-confirm="{% translate 'Are you sure you want to delete this item?' %}"
                        hx-target="closest tr"
                        hx-swap="outerHTML swap:300ms"
                        title="{% translate 'Delete' %}">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
                </button>
            </td>
            {% endif %}
        </tr>
        {% endfor %}
    </tbody>
</table>
<p class="paginator">{{ cl.result_count }} {{ opts.verbose_name_plural }}</p>
{% else %}
<p class="paginator">{% translate "0 results" %}</p>
{% endif %}
